---
layout: page
title: Using the Cross Site Scripting Detection Policy in Policy Manager 7.x
description: Learn how configure a tag white list to protect your web service from being exploited by cross site scripting.
product: ag
category: learn
weight:	5
subcategory: Policies
type: page
nav-title: Using the Cross Site Scripting Policy
---


<a name="top"></a>
<div class="documentation supportContent">
  <h2 name="top">Using the Cross-Site Scripting Detection Policy</h2>
  <p>Learn how to configure tag white and black lists to protect your web service from being exploited by cross site scripting attacks. </p>

<a href="policy_management.htm" class="button secondary">Managing Policies</a>
  <p></p>
  <div class = "divider1"></div>
   <h3 style="color: gray;">Table of Contents</h3>

   <ol class="table_of_contents">

 <li><a href="#introduction">Introduction</a></li>


 <li><a href="#black_list_default_policy">Black List Default Policy</a></li>

  <li><a href="#configuration">Configuration</a></li>


  </ol>
  <div class = "divider1"></div><p></p>

<a name="introduction">
<h3>Introduction</h3></a>

<p>The Cross Site Scripting Detection Policy is an Operational policy that allows you to block potentially malicous HTML tags in the request message body using <em>black</em> and <em>white</em> lists of tags. </p>
<ul class="usingOrderedList">
  <li>The black list includes a list of HTML tags that will be blocked if they are found in the request message body. </li>
  <li>The  white list (which you define in the policy definition) includes a set of tags and attributes that are allowed in the request message body. If a white list tag is found, Network Director passes the request message to the downstream service. </li>
</ul>

 <p>Say for example your web service includes an anchor &lt;a&gt; tag. When you attach a default Cross Site Scripting Detection Policy to a REST service and send a request message to the Network Director container that is hosting the service, you will receive an &quot;HTTP 403 Forbidden&quot; error. This is because the &lt;a&gt; tag is not defined in the policy's &quot;white list.&quot;</p>


 <p><a href="#top">Back to top</a></p>


<a name="black_list_default_policy">
<h3>Black List (Default Policy)</h3></a>



<p>The default policy state includes a black list with the following tags:</p>
<p><img src="cross_site_blacklist1.jpg" width="388" height="346"></p>
<p><img src="cross_site_blacklist2.jpg" width="373" height="356"></p>



 <p><a href="#top">Back to top</a></p>



<a name="configuration">
<h3>Configuration</h3></a>



<p>Let's take a quick walkthrough of the Cross Site Scripting Detection  Policy configuration process to get your started.</p>
<h5>Step 1: Add Policy / Use System Policy</h5>
<ul class="usingOrderedList">
  <li>You can create a Cross Site Scripting Detection policy instance using <strong>Add Policy</strong> in the <em>Policies &gt; Operational Policies</em> section.</li>
  <li>You can also take advantage of the pre-defined Cross Site Scripting Detection Policy called <strong>WhiteListedCrossSiteScripting</strong>. This is an  out-of-box System Policy that is preconfigured with the default white list. You can customize the white list configuration to suit your needs and then attach it directly to a service or operation. If you use the default configuration all tags in the white list   all tags will be accepted when Network Director  passes the request message to the downstream service.</li>
</ul>
<h5>Step 2: Modify Policy</h5>
<p>When you <strong>Modify</strong> the Cross Site Scripting Detection policy on the <em>Policy Details</em> page the initial policy will look like this:</p>
<p><img src="modify_cross_site_scripting_policy.jpg" width="430" height="489"></p>
<p>If you use the default policy (without defining a white list) all tags in the default black list (listed above) will be forbidden when Network Director  passes the request message to the downstream service and an HTTP 404 Forbidden error will be raised.</p>
<h5>Step 3: Configure White List / Custom Tags</h5>
<p>The next step is to define your tag white list. These represent tags that comprise the HTML in your request message body and that you have designated as ones that could be  potentially attacked. White list tags are allowed when Network Director passes the request message to the downstream service.  The following options are available:</p>
<h5></h5>
<ul class="usingOrderedList">
  <li>Use  <strong>Add Default HTML Tags</strong>  to add a default set of tags (i.e.,  adds the black list to your policy) and customize using the <strong>Remove Selected Row</strong> option.</li>
  <li>Use  <strong>Add Tag</strong>  to add a custom tag and attributes (if applicable).</li>
</ul>
<h5>Step 4: Attach Policy</h5>
<p>After you have saved your policy you can  attach it to a web service  or you can attach the policy at the Organization level and the policy will be active for all services defined within the orgnization. </p>
<p><img src="attach policy.jpg" width="485" height="221"></p>


<p><a href="#top">Back to top</a></p>

<div class = "divider1"></div>
